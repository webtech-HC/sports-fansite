<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tennessee — Game Weekend Guide</title>
  <meta name="description" content="Everything you need for game weekend in Knoxville—before, during, and after kickoff." />
  <link rel="preload" href="/assets/css/styles.css" as="style" />
  <link rel="stylesheet" href="/assets/css/styles.css" />
  <link rel="icon" href="/assets/tn.png" />
  <meta name="theme-color" content="#f57f17" />
</head>
<body class="theme-tn">

  <!-- ===== Header (shared style) ===== -->
  <header class="site-header">
    <nav class="nav">
      <a class="brand" href="/index.html" aria-label="Tennessee home">
        <span class="brand-badge">TN</span>
        <span class="brand-name">Tennessee</span>
      </a>

      <ul class="nav-links">
        <li><a href="/schedule.html">Schedule</a></li>
        <li><a href="/specials.html">Specials</a></li>
        <li><a href="/map.html">Map</a></li>
        <li class="active"><a href="/guide.html" aria-current="page">Guide</a></li>
        <li><a class="btn btn-primary" href="/submit.html">Submit</a></li>
      </ul>

      <!-- countdown lives in the header for every page -->
      <div id="hd-countdown" class="countdown countdown--header" aria-live="polite">
        <div class="ct-seg"><span class="ct-num">00</span><span class="ct-lab">days</span></div>
        <div class="ct-sep">:</div>
        <div class="ct-seg"><span class="ct-num">00</span><span class="ct-lab">hrs</span></div>
        <div class="ct-sep">:</div>
        <div class="ct-seg"><span class="ct-num">00</span><span class="ct-lab">mins</span></div>
        <div class="ct-sep">:</div>
        <div class="ct-seg"><span class="ct-num">00</span><span class="ct-lab">secs</span></div>
      </div>
    </nav>
  </header>

  <main class="wrap guide-wrap">

    <!-- ===== Page Title + actions ===== -->
    <section class="page-intro">
      <h1>Game Weekend Guide</h1>
      <p class="muted">Everything you need for game weekend in Knoxville—before, during, and after kickoff.</p>
      <div class="actions">
        <a id="btnAddCal" class="btn btn-primary" href="#" target="_blank" rel="noopener">Add next game to Calendar</a>
        <a id="btnPrint" class="btn" href="javascript:window.print()">Print guide</a>
      </div>
    </section>

    <!-- ===== Grid: main + right rail ===== -->
    <div class="grid guide-grid">

      <!-- ===== Main column ===== -->
      <div class="col-main flow">

        <!-- snapshot bar with jump links -->
        <section class="card">
          <div class="card-hd">
            <h2 class="card-title">Game-day snapshot</h2>
            <div id="nextGameSmall" class="badge badge-soft">Next game: <span>Loading…</span></div>
          </div>
          <nav class="chip-row">
            <a class="chip" href="#pre">Pre-game</a>
            <a class="chip" href="#game">Game-time</a>
            <a class="chip" href="#post">Post-game</a>
            <a class="chip" href="#emergency">Emergency & help</a>
          </nav>
        </section>

        <!-- Timeline (relative, filled from next kickoff) -->
        <section class="card" id="timeline">
          <h3 class="card-title">Timeline</h3>
          <p class="muted">Times below auto-calculate from the next scheduled kickoff.</p>
          <ul class="timeline-list" id="timelineList">
            <li>Loading…</li>
          </ul>
        </section>

        <!-- ========= PRE-GAME ========= -->
        <section class="card" id="pre">
          <h2 class="section-title">Pre-game</h2>

          <div class="split two">
            <div class="split-col">
              <h3>Parking & getting there</h3>
              <ul class="dot-list">
                <li><strong>Arrive early</strong>—near campus lots fill 3–4 hours pre-kick for big games.</li>
                <li><strong>Expect lane closures</strong>. Check the live map (right) for a faster route.</li>
                <li>Rideshare: pick a pickup point a few blocks from the stadium for quicker exits.</li>
              </ul>
            </div>
            <div class="split-col">
              <h3>Bags & entry</h3>
              <div class="grid two">
                <div>
                  <h4>Generally allowed</h4>
                  <ul class="dot-list">
                    <li>Small clear bag</li>
                    <li>Factory-sealed water</li>
                    <li>Phone, keys, charger</li>
                  </ul>
                </div>
                <div>
                  <h4>Generally not allowed</h4>
                  <ul class="dot-list">
                    <li>Backpacks/large bags</li>
                    <li>Outside food/alcohol</li>
                    <li>Umbrellas, noisemakers (varies)</li>
                  </ul>
                </div>
              </div>
              <p class="fine">Policies can change—verify day-of.</p>
            </div>
          </div>

          <div class="split two">
            <div class="split-col">
              <h3>With kids</h3>
              <ul class="dot-list">
                <li>Family restrooms & changing tables available—ask staff near your section.</li>
                <li>Bring ear protection; pack wipes and a spare layer for breeze after sunset.</li>
              </ul>
            </div>
            <div class="split-col">
              <h3>Accessibility</h3>
              <ul class="dot-list">
                <li>Use elevators and accessible routes as posted—staff can guide you.</li>
                <li>Service animals typically permitted—follow venue guidance.</li>
              </ul>
            </div>
          </div>
        </section>

        <!-- ========= GAME-TIME ========= -->
        <section class="card" id="game">
          <h2 class="section-title">Game-time</h2>

          <div class="split two">
            <div class="split-col">
              <h3>Inside the stadium</h3>
              <ul class="dot-list">
                <li><strong>Hydrate & shade</strong>: refill stations on main concourses, sunscreen, brimmed hats.</li>
                <li><strong>Mobile tickets</strong>: brighten your screen before the scanners.</li>
                <li>Keep an eye on the <a href="/index.html#live">Live Score Box</a> for quick updates.</li>
              </ul>
            </div>
            <div class="split-col">
              <h3>Food & cashless</h3>
              <ul class="dot-list">
                <li>Most vendors are cashless; set up wallet beforehand.</li>
                <li>Grab concessions mid-quarter to avoid lines.</li>
              </ul>
            </div>
          </div>
        </section>

        <!-- ========= POST-GAME ========= -->
        <section class="card" id="post">
          <h2 class="section-title">Post-game</h2>
          <div class="split two">
            <div class="split-col">
              <h3>Traffic tips</h3>
              <ul class="dot-list">
                <li><strong>Wait 20–30 minutes</strong> if you parked close—saves time overall.</li>
                <li>Use side streets or move north (when open) to beat main flow.</li>
                <li>Walk outside control points before calling rideshare.</li>
              </ul>
            </div>
            <div class="split-col">
              <h3>Food & drink</h3>
              <ul class="dot-list">
                <li>Check <a href="/specials.html">Specials</a> for fan-friendly spots and hours.</li>
                <li>Family sections and quieter eats are a short drive north of campus.</li>
              </ul>
            </div>
          </div>
        </section>

        <!-- ========= EMERGENCY & HELP ========= -->
        <section class="card" id="emergency">
          <h2 class="section-title">Emergency & help</h2>
          <div class="grid two">
            <div>
              <h3>Call or text</h3>
              <ul class="dot-list">
                <li><strong>Emergency</strong>: dial <a href="tel:911">911</a></li>
                <li><strong>Mental health</strong>: call or text <a href="tel:988">988</a></li>
                <li><strong>Poison control</strong>: <a href="tel:18002221222">1-800-222-1222</a></li>
              </ul>
            </div>
            <div>
              <h3>Local resources</h3>
              <ul class="dot-list">
                <li><a href="https://safety.utk.edu/" target="_blank" rel="noopener">UT Police & campus safety</a></li>
                <li><a href="https://www.knoxvilletn.gov/government/city_departments_offices/police_department" target="_blank" rel="noopener">Knoxville Police Department</a></li>
                <li><a href="https://www.knoxsheriff.org/" target="_blank" rel="noopener">Knox County Sheriff</a></li>
                <li><a href="https://www.kub.org/outage-center/" target="_blank" rel="noopener">KUB Outage Center</a></li>
              </ul>
              <p class="fine">Links open official sites—confirm non-emergency numbers there.</p>
            </div>
          </div>
        </section>

      </div><!-- /col-main -->

      <!-- ===== Right rail (sticky) ===== -->
      <aside class="col-rail">
        <!-- Weather -->
        <section class="card" id="wxCard">
          <h3 class="card-title">Weather now</h3>
          <div id="wxNow" class="wx-now">Loading…</div>
        </section>

        <!-- Live traffic near Neyland -->
        <section class="card">
          <h3 class="card-title">Traffic & Map</h3>
          <p class="fine">Pin centers near Neyland. Explore closures & backups.</p>
          <div class="iframe-wrap">
            <iframe
              title="Waze live map — Neyland area"
              loading="lazy"
              src="https://embed.waze.com/iframe?zoom=14&lat=35.955&lon=-83.925&pin=1"
              allowfullscreen
              referrerpolicy="no-referrer-when-downgrade"></iframe>
          </div>
        </section>

        <!-- Quick links -->
        <section class="card">
          <h3 class="card-title">Quick links</h3>
          <ul class="link-list">
            <li><a href="/guide.html">Guide</a></li>
            <li><a href="/specials.html">Specials</a></li>
            <li><a href="/map.html">Map</a></li>
            <li><a href="/schedule.html">Schedule</a></li>
            <li><a href="/submit.html">Submit a listing</a></li>
          </ul>
        </section>
      </aside>

    </div><!-- /grid -->

  </main>

  <footer class="site-footer">
    <p class="fine">
      Unofficial fan resource. Not affiliated with any university, athletics program, conference, or governing body.
    </p>
    <nav class="foot-links">
      <a href="/guide.html">Guide</a> ·
      <a href="/specials.html">Specials</a> ·
      <a href="/map.html">Map</a> ·
      <a href="/schedule.html">Schedule</a> ·
      <a href="/submit.html">Submit</a>
    </nav>
    <p class="fine">© 2025 HC Web Labs. Content licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0</a>.</p>
  </footer>

  <!-- ===== Page-local scripts (self-contained, no keys) ===== -->
  <script>
  (function () {
    // --- small helpers
    const $ = (sel, ctx=document) => ctx.querySelector(sel);
    const fmt = (d) => new Date(d).toLocaleString(undefined, {
      weekday:'short', month:'short', day:'numeric', hour:'numeric', minute:'2-digit'
    });
    const fmtDate = (d, opts) => new Date(d).toLocaleString(undefined, opts||{hour:'numeric',minute:'2-digit'});

    // --- next game + countdown + Google Calendar link
    async function bootSchedule() {
      try {
        const res = await fetch('/data/schedule.json', { cache:'no-store' });
        if (!res.ok) throw new Error('schedule missing');
        const raw = await res.json();
        const list = Array.isArray(raw) ? raw : (raw.games || []);
        const now = Date.now();
        const next = list.find(g => new Date(g.start).getTime() > now);
        const span = $('#nextGameSmall span');
        if (next) {
          span.textContent = fmt(next.start) + (next.opponent ? ` — vs ${next.opponent}` : '');
          wireCountdown(new Date(next.start));
          // Google Calendar "create event" link
          const s = new Date(next.start);
          const e = new Date(s.getTime() + 3*60*60*1000);
          const pad = n => String(n).padStart(2,'0');
          const mk = (dt) => dt.getUTCFullYear()
            + pad(dt.getUTCMonth()+1) + pad(dt.getUTCDate()) + 'T'
            + pad(dt.getUTCHours()) + pad(dt.getUTCMinutes()) + '00Z';
          const text = encodeURIComponent('Tennessee Football vs ' + (next.opponent||'Opponent'));
          const details = encodeURIComponent('Unofficial fan calendar entry from sports-fansite.');
          const location = encodeURIComponent('Neyland Stadium, Knoxville, TN');
          const href = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${text}&dates=${mk(s)}/${mk(e)}&location=${location}&details=${details}`;
          $('#btnAddCal').href = href;
        } else {
          span.textContent = 'TBA';
        }
        buildTimeline(next);
      } catch (err) {
        console.warn('schedule error', err);
        $('#nextGameSmall span').textContent = 'TBA';
      }
    }

    function wireCountdown(targetDate) {
      const root = $('#hd-countdown');
      if (!root) return;
      function tick() {
        const t = targetDate - new Date();
        const segs = [86400000, 3600000, 60000, 1000].map((ms, i, arr) => {
          const v = i===0 ? Math.floor(t/ms) : Math.floor((t%arr[i-1])/ms);
          return v < 0 ? 0 : v;
        });
        [...root.querySelectorAll('.ct-num')].forEach((el, i) => el.textContent = String(segs[i]).padStart(2,'0'));
      }
      tick();
      setInterval(tick, 1000);
    }

    function buildTimeline(next) {
      const ul = $('#timelineList');
      ul.innerHTML = '';
      if (!next) {
        ul.innerHTML = '<li>Populates once a future game is on the schedule.</li>';
        return;
      }
      const k = new Date(next.start);
      const items = [
        { t: new Date(k.getTime() - 4*60*60*1000), label:'Arrive to campus, park & explore' },
        { t: new Date(k.getTime() - 3*60*60*1000), label:'Tailgates & pre-game spots warm up' },
        { t: new Date(k.getTime() - 2*60*60*1000), label:'Gates typically open; security lines build' },
        { t: new Date(k.getTime() - 60*60*1000),  label:'Head to seats & grab food' },
        { t: k,                                   label:'Kickoff' },
        { t: new Date(k.getTime() + 3*60*60*1000), label:'Post-game: staggered exits help traffic' }
      ];
      for (const it of items) {
        const li = document.createElement('li');
        li.innerHTML = `<span class="tl-time">${fmtDate(it.t)}</span><span class="tl-dot"></span><span>${it.label}</span>`;
        ul.appendChild(li);
      }
    }

    // --- live Knoxville weather (Open-Meteo; no key)
    async function bootWeather() {
      const lat = 35.955, lon = -83.925; // Neyland area
      const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,wind_speed_10m&daily=weather_code,temperature_2m_max,temperature_2m_min&temperature_unit=fahrenheit&wind_speed_unit=mph&timezone=auto`;
      try {
        const res = await fetch(url, { cache: 'no-store' });
        const j = await res.json();
        const curT = Math.round(j.current.temperature_2m);
        const wind = Math.round(j.current.wind_speed_10m);
        $('#wxNow').innerHTML =
          `<div class="wx-row"><strong>${curT}°F</strong> <span class="fine">Feels like —</span></div>
           <div class="wx-row"><span class="fine">Wind</span> <strong>${wind} mph</strong></div>
           <div class="fine">Knoxville just now.</div>`;
      } catch (e) {
        console.warn('weather', e);
        $('#wxNow').textContent = 'Weather unavailable.';
      }
    }

    bootSchedule();
    bootWeather();
  })();
  </script>
</body>
</html>
